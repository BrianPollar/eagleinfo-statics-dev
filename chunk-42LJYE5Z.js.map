{
  "version": 3,
  "sources": ["projects/admin-panel/src/app/components/pane/auto-tax/add-update-auto-tax/add-update-auto-tax.component.ts", "projects/admin-panel/src/app/components/pane/auto-tax/add-update-auto-tax/add-update-auto-tax.component.html"],
  "sourcesContent": ["import { Location } from '@angular/common';\nimport { Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, FormsModule, ReactiveFormsModule, Validators } from '@angular/forms';\nimport { Meta, Title } from '@angular/platform-browser';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { AutomaticItemTax } from '@biz-nest/commerce-client';\nimport {\n  BizNestClientError, FrontendLogger, getBizNestErrorResponseMessage,\n  TautomaticItemTaxRequest\n} from '@biz-nest/core-client';\nimport {\n  AppNameService, EventbusService,\n  MainBarTitleService, markFormGroupTouched,\n  patternWithMessage,\n  scrollToTop,\n  WindowService\n} from '@front-shared-lib';\nimport { controlNames, Icrumb, navByBus, runSubscriptionsForSharedUse } from '@main-shared-lib';\nimport { ToastrService } from 'ngx-toastr';\nimport { AdminBackBarComponent } from '../../misc/admin-back-bar/admin-back-bar.component';\nimport { AdminFormInstructionComponent } from '../../misc/admin-form-instruction/admin-form-instruction.component';\nimport { AdminPageContentComponent } from '../../misc/admin-page-content/admin-page-content.component';\nimport { AdminFormFieldComponent } from '../../misc/form/admin-form-field/admin-form-field.component';\nimport { AdminSelectFieldComponent } from '../../misc/form/admin-select-field/admin-select-field.component';\nimport { AdminTextareaFieldComponent } from '../../misc/form/admin-textarea-field/admin-textarea-field.component';\nimport { AdminFormButtonComponent } from '../../misc/form/button/admin-form-button/admin-form-button.component';\n\n@Component({\n  selector: 'app-add-update-auto-tax',\n  standalone: true,\n  imports: [\n    FormsModule,\n    ReactiveFormsModule,\n    AdminBackBarComponent,\n    AdminFormFieldComponent,\n    AdminSelectFieldComponent,\n    AdminTextareaFieldComponent,\n    AdminFormButtonComponent,\n    AdminPageContentComponent,\n    AdminFormInstructionComponent\n  ],\n  templateUrl: './add-update-auto-tax.component.html',\n  styleUrl: './add-update-auto-tax.component.scss'\n})\nexport class AddUpdateAutoTaxComponent\nimplements OnInit, OnDestroy {\n  form: FormGroup<{\n    [K in keyof Partial<TautomaticItemTaxRequest<true> & {other: string}>]\n  }>;\n\n  automaticItemTax?: AutomaticItemTax;\n  posting = false;\n  cleanup?: () => void;\n  countUsers = 0;\n  navigateByBus = navByBus(this.eventbus, this.router).navigateByBus;\n  breadCrumbs: Icrumb[] = [\n    {\n      name: 'Dashboard',\n      icon: 'space_dashboard',\n      link: '/'\n    },\n    {\n      name: 'Auto Tax',\n      icon: 'assessment',\n      link: '/auto-tax/list'\n    },\n    {\n      name: 'Edit Auto Tax',\n      icon: 'edit'\n    }\n  ];\n\n  statusOptionsArray = [\n    { value: true, label: 'Active' },\n    { value: false, label: 'Inactive' }\n  ];\n\n  constructor(\n    private fb: FormBuilder,\n    public router: Router,\n    private route: ActivatedRoute,\n    private toastr: ToastrService,\n    private eventbus: EventbusService,\n    private apNme: AppNameService,\n    public mainBarTitle: MainBarTitleService,\n    private location: Location,\n    private windowService: WindowService,\n    private metaTagService: Meta,\n    private titleService: Title\n  ) {\n    const editAction = this.route.snapshot?.params['editAction'];\n\n    this.mainBarTitle.title = editAction === 'add' ? 'Add  Automatic Item Tax' : 'Update  Automatic Item Tax';\n    this.form = this.fb.group<{\n      [K in keyof Partial<TautomaticItemTaxRequest<true> & { other: string}>]\n    }>({\n      name: ['', Validators.compose([\n        Validators.minLength(4),\n        Validators.maxLength(60),\n        Validators.required])],\n      percentage: ['', Validators.compose([\n        Validators.min(0),\n        Validators.max(100),\n        patternWithMessage(/^[0-9]+(\\.[0-9]+)?$/, 'Must be a valid number.'),\n        Validators.required])],\n      enforcer: [\n        '',\n        Validators.compose([\n          Validators.minLength(1),\n          Validators.maxLength(120),\n          Validators.required\n        ])],\n      active: [''],\n      reason: ['']\n    });\n  }\n\n  get controlNames() {\n    return controlNames(this.form.controls);\n  }\n\n  ngOnInit() {\n    const handlers = {\n      updateAutomaticItemTax: (data: AutomaticItemTax) => {\n        if (!data._id || !data.name || !data.percentage || !data.enforcer) {\n          throw new BizNestClientError('Invalid AutomaticItemTax: missing required fields (_id, name, rate, or type)');\n        }\n        this.automaticItemTax = data;\n        this.form.patchValue(this.automaticItemTax);\n        this.mainBarTitle.title = 'Update Automatic Item Tax - ' + data.name;\n      }\n    };\n\n    const { cleanup } = runSubscriptionsForSharedUse(this.eventbus, handlers);\n\n    this.cleanup = cleanup;\n    this.titleService.setTitle(this.mainBarTitle.title + ' - ' + this.apNme.name);\n    this.metaTagService.updateTag({\n      name: 'description',\n      content: `Efficiently manage automatic tax settings for items,\n      including compliance with revenue authority regulations.`\n    });\n  }\n\n\n  checkControlInvalidOrDirty(controlName: keyof Partial<TautomaticItemTaxRequest<true> & { other: string}>) {\n    return !this.form.get(controlName)?.valid &&\n    this.form.get(controlName)?.dirty;\n  }\n\n\n  async saveChanges() {\n    if (this.form.invalid) {\n      markFormGroupTouched(this.form, this);\n      scrollToTop(this.windowService);\n\n      return;\n    }\n\n    this.posting = true;\n\n    const formValues = this.form.value;\n\n    const details: TautomaticItemTaxRequest<true> = {\n      name: formValues.name,\n      percentage: Number(formValues?.percentage),\n      enforcer: formValues.enforcer,\n      active: formValues.active === 'true',\n      reason: formValues.reason,\n      includeOnlyIds: this.automaticItemTax?.includeOnlyIds || [],\n      excludeIds: this.automaticItemTax?.excludeIds || []\n    };\n\n    try {\n      this.posting = true;\n      if (this.automaticItemTax) {\n        await this.automaticItemTax.update(details);\n      } else {\n        await AutomaticItemTax.add(details);\n      }\n\n      this.toastr.success('Operation sucessfull...!', 'Success');\n      this.form.reset();\n      if (this.automaticItemTax) {\n        this.location.back();\n      }\n\n      scrollToTop(this.windowService);\n    } catch (error) {\n      FrontendLogger.error('AddExpensesComponent:saveChanges:: - error ', error);\n      this.toastr.error(getBizNestErrorResponseMessage(error), 'Failed', {\n        disableTimeOut: true\n      });\n    } finally {\n      this.posting = false;\n    }\n  }\n\n  ngOnDestroy() {\n    this.cleanup?.();\n  }\n}\n\n", "<app-admin-page-content>\n  <app-admin-back-bar\n    [title]=\"mainBarTitle.title\"\n    [breadCrumbs]=\"breadCrumbs\"\n  />\n  <div\n    class=\"container mx-auto md:px-6 md:pt-32 pb-32 pt-12 !mn-h-[100vh] !mb-[180px]\"\n  >\n    <section class=\"text-center min-h-[100vh] mx-auto max-w-[700px]\">\n      <app-admin-form-instruction />\n      <div class=\"md:px-3 h-full flex items-center justify-center\">\n        <form\n          class=\"space-y-8 !bg-default-white p-10 rounded-2xl shadow-2xl border !border-default-white-shade backdrop-blur-sm w-full\"\n          [formGroup]=\"form\"\n          (ngSubmit)=\"saveChanges()\"\n        >\n          <div class=\"text-center mb-6\">\n            <h2 class=\"text-3xl font-extrabold tracking-tight\">\n              Automaic Tax Details\n            </h2>\n            <p class=\"mt-2 text-sm\">\n              Provide comprehensive information about the automatic taxes\n            </p>\n          </div>\n\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <app-admin-form-field\n              [formControlName]=\"controlNames.name\"\n              [label]=\"'Name'\"\n            />\n\n            <app-admin-form-field\n              [formControlName]=\"controlNames.percentage\"\n              [label]=\"'Percentage'\"\n            />\n          </div>\n\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <app-admin-form-field\n              [formControlName]=\"controlNames.enforcer\"\n              [label]=\"'Enforcer'\"\n            />\n\n            <app-admin-select-field\n              [formControlName]=\"controlNames.active\"\n              [options]=\"statusOptionsArray\"\n              label=\"Status\"\n              placeholderOption=\"Select a status\"\n            />\n          </div>\n\n          <app-admin-textarea-field\n            [formControlName]=\"controlNames.reason\"\n            [label]=\"'Description'\"\n            class=\"mb-10\"\n          />\n\n          <app-admin-form-button\n            [btnText]=\"'Save'\"\n            [tooltip]=\"'Saves Automatic Tax.'\"\n            [disabled]=\"posting\"\n            [posting]=\"posting\"\n            (save)=\"saveChanges()\"\n          />\n        </form>\n      </div>\n    </section>\n  </div>\n</app-admin-page-content>\n"],
  "mappings": "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",
  "names": []
}
