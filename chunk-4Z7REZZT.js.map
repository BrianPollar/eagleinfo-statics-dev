{
  "version": 3,
  "sources": ["projects/admin-panel/src/app/components/pane/notification/notif-key/add-update-notif-key/add-update-notif-key.component.ts", "projects/admin-panel/src/app/components/pane/notification/notif-key/add-update-notif-key/add-update-notif-key.component.html"],
  "sourcesContent": ["import { Location } from '@angular/common';\nimport { Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, FormsModule, ReactiveFormsModule, Validators } from '@angular/forms';\nimport { Meta, Title } from '@angular/platform-browser';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Company } from '@biz-nest/commerce-client';\nimport {\n  BizNestClientError, FrontendLogger, getBizNestErrorResponseMessage, InotifApiKey\n} from '@biz-nest/core-client';\nimport { NotificationApiKey } from '@biz-nest/notification-client';\nimport {\n  AppNameService, EventbusService, IselectOption,\n  MainBarTitleService, markFormGroupTouched,\n  patternWithMessage,\n  scrollToTop,\n  SoloDateComponent,\n  WindowService\n} from '@front-shared-lib';\nimport { controlNames, Icrumb, navByBus, runSubscriptionsForSharedUse } from '@main-shared-lib';\nimport { ToastrService } from 'ngx-toastr';\nimport { AdminBackBarComponent } from '../../../misc/admin-back-bar/admin-back-bar.component';\nimport { AdminFormInstructionComponent } from '../../../misc/admin-form-instruction/admin-form-instruction.component';\nimport { AdminPageContentComponent } from '../../../misc/admin-page-content/admin-page-content.component';\nimport { AdminFormFieldComponent } from '../../../misc/form/admin-form-field/admin-form-field.component';\nimport { AdminSelectFieldComponent } from '../../../misc/form/admin-select-field/admin-select-field.component';\nimport { AdminFormButtonComponent } from '../../../misc/form/button/admin-form-button/admin-form-button.component';\n\n@Component({\n  selector: 'app-add-update-notif-key',\n  standalone: true,\n  imports: [\n    FormsModule,\n    ReactiveFormsModule,\n    AdminBackBarComponent,\n    AdminFormFieldComponent,\n    AdminSelectFieldComponent,\n    AdminFormButtonComponent,\n    AdminPageContentComponent,\n    AdminFormInstructionComponent,\n    SoloDateComponent\n  ],\n  templateUrl: './add-update-notif-key.component.html',\n  styleUrl: './add-update-notif-key.component.scss'\n})\nexport class AddUpdateNotifKeyComponent\nimplements OnInit, OnDestroy {\n  form: FormGroup<{\n    [K in keyof Partial<InotifApiKey & {other: string}>]\n  }>;\n\n  notifKey?: NotificationApiKey;\n  posting = false;\n  cleanup?: () => void;\n  countUsers = 0;\n  navigateByBus = navByBus(this.eventbus, this.router).navigateByBus;\n  breadCrumbs: Icrumb[] = [\n    {\n      name: 'Dashboard',\n      icon: 'space_dashboard',\n      link: '/'\n    },\n    {\n      name: 'Notification Key',\n      icon: 'assessment',\n      link: '/auto-tax/list'\n    },\n    {\n      name: 'Edit Notification Key',\n      icon: 'edit'\n    }\n  ];\n\n  enabledOptionsArray = [\n    { value: true, label: 'Enabled' },\n    { value: false, label: 'Disabled' }\n  ];\n\n  companiesArray: IselectOption[] = [];\n\n  companies: Company[] = [];\n\n  constructor(\n    private fb: FormBuilder,\n    private router: Router,\n    private location: Location,\n    private route: ActivatedRoute,\n    private toastr: ToastrService,\n    private eventbus: EventbusService,\n    private apNme: AppNameService,\n    private windowService: WindowService,\n    public mainBarTitle: MainBarTitleService,\n    private metaTagService: Meta,\n    private titleService: Title\n  ) {\n    const editAction = this.route.snapshot?.params['editAction'];\n\n    this.mainBarTitle.title = editAction === 'add' ? 'Add  Notification Key' : 'Update  Notification Key';\n    this.form = this.fb.group<{\n      [K in keyof Partial<InotifApiKey & { other: string}>]\n    }>({\n      maxEmails: ['', Validators.compose([\n        Validators.min(0),\n        Validators.max(100),\n        patternWithMessage(/^[0-9]+(\\.[0-9]+)?$/, 'Must be a valid number.'),\n        Validators.required])],\n      maxSms: ['', Validators.compose([\n        Validators.min(0),\n        Validators.max(100),\n        patternWithMessage(/^[0-9]+(\\.[0-9]+)?$/, 'Must be a valid number.'),\n        Validators.required])],\n      enabled: ['', Validators.required],\n      expiresAt: ['', Validators.required],\n      owner: ['', Validators.required]\n    });\n  }\n\n  get controlNames() {\n    return controlNames(this.form.controls);\n  }\n\n  ngOnInit() {\n    const handlers = {\n      updateNotificationApiKey: (data: NotificationApiKey) => {\n        if (!data._id || !data.apiKey || !data.enabled || !data.expiresAt || !data.owner) {\n          throw new BizNestClientError(`Invalid NotificationApiKey: missing\n            required fields (_id, apiKey, enabled, expiresAt, or owner`);\n        }\n        this.notifKey = data;\n        this.form.patchValue(this.notifKey);\n        this.mainBarTitle.title = 'Update Notification Key - ' + data.apiKey;\n      }\n    };\n\n    const { cleanup } = runSubscriptionsForSharedUse(this.eventbus, handlers);\n\n    this.cleanup = cleanup;\n    this.getCompanies();\n    this.titleService.setTitle(this.mainBarTitle.title + ' - ' + this.apNme.name);\n    this.metaTagService.updateTag({\n      name: 'description',\n      content: `Efficiently manage automatic tax settings for items,\n      including compliance with revenue authority regulations.`\n    });\n  }\n\n  checkControlInvalidOrDirty(controlName: keyof Partial<InotifApiKey & { other: string}>) {\n    return !this.form.get(controlName)?.valid &&\n    this.form.get(controlName)?.dirty;\n  }\n\n  notifyDate(date?: Date) {\n    this.form.get('expiresAt')?.setValue(date);\n  }\n\n  async getCompanies() {\n    try {\n      const { dataArr } = await Company.filterAll({});\n\n      this.companies = dataArr;\n      this.companiesArray = dataArr.map((company) => ({\n        value: company._id,\n        label: company.name\n      }));\n    } catch (err) {\n      FrontendLogger.error('AddUpdateNotifKeyComponent:Companies:: - err ', err);\n    }\n  }\n\n  async saveChanges() {\n    if (this.form.invalid) {\n      markFormGroupTouched(this.form, this);\n      scrollToTop(this.windowService);\n\n      return;\n    }\n\n    this.posting = true;\n\n    const formValues = this.form.value;\n\n    const details = {\n      apiKey: formValues.apiKey,\n      owner: formValues.owner,\n      enabled: formValues.enabled === 'true',\n      expiresAt: formValues.expiresAt ? new Date(formValues.expiresAt) : undefined,\n      maxEmails: parseInt(formValues.maxEmails, 10),\n      maxSms: parseInt(formValues.maxSms, 10)\n    };\n\n    try {\n      if (this.notifKey) {\n        await this.notifKey.update(details);\n      } else {\n        await NotificationApiKey.add(details);\n      }\n\n      this.toastr.success('Operation sucessfull...!', 'Success');\n      this.form.reset();\n      if (this.notifKey) {\n        this.location.back();\n      }\n\n      scrollToTop(this.windowService);\n    } catch (error) {\n      FrontendLogger.error('AddExpensesComponent:saveChanges:: - err ', error);\n\n      this.toastr.error(getBizNestErrorResponseMessage(error), 'Failed', {\n        disableTimeOut: true\n      });\n    } finally {\n      this.posting = false;\n    }\n  }\n\n  ngOnDestroy() {\n    this.cleanup?.();\n  }\n}\n\n", "<app-admin-page-content>\n  <app-admin-back-bar\n    [title]=\"mainBarTitle.title\"\n    [breadCrumbs]=\"breadCrumbs\"\n  />\n  <div\n    class=\"container mx-auto md:px-6 md:pt-32 pb-32 pt-12 !mn-h-[100vh] !mb-[180px]\"\n  >\n    <section class=\"text-center min-h-[100vh] mx-auto max-w-[700px]\">\n      <app-admin-form-instruction />\n      <div class=\"md:px-3 h-full flex items-center justify-center\">\n        <form\n          class=\"space-y-8 !bg-default-white p-10 rounded-2xl shadow-2xl border !border-default-white-shade backdrop-blur-sm w-full\"\n          [formGroup]=\"form\"\n          (ngSubmit)=\"saveChanges()\"\n        >\n          <div class=\"text-center mb-6\">\n            <h2 class=\"text-3xl font-extrabold tracking-tight\">\n              Notification Key Details\n            </h2>\n            <p class=\"mt-2 text-sm text-gray-500\">\n              Provide comprehensive information about the notification key\n            </p>\n          </div>\n\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <app-admin-form-field\n              [formControlName]=\"controlNames.maxEmails\"\n              [label]=\"'Max Emails'\"\n            />\n\n            <app-admin-form-field\n              [formControlName]=\"controlNames.maxSms\"\n              [label]=\"'Max SMS'\"\n            />\n          </div>\n\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <app-admin-select-field\n              [formControlName]=\"controlNames.enabled\"\n              [options]=\"enabledOptionsArray\"\n              label=\"Enabled\"\n              placeholderOption=\"Select a status\"\n            />\n\n            <app-admin-select-field\n              [formControlName]=\"controlNames.owner\"\n              [options]=\"companiesArray\"\n              label=\"Owner\"\n              placeholderOption=\"Select a status\"\n            />\n          </div>\n\n          <div>\n            <lib-solo-date\n              placeholder=\"Date Added\"\n              (notify)=\"notifyDate($event)\"\n            />\n          </div>\n\n          <app-admin-form-button\n            [btnText]=\"'Save'\"\n            [tooltip]=\"'Saves Notification Key.'\"\n            [disabled]=\"posting\"\n            [posting]=\"posting\"\n            (save)=\"saveChanges()\"\n          />\n        </form>\n      </div>\n    </section>\n  </div>\n</app-admin-page-content>\n"],
  "mappings": "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",
  "names": []
}
