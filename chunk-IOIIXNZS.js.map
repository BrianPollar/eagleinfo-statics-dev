{
  "version": 3,
  "sources": ["projects/shared-lib/src/lib/services/data.service.ts"],
  "sourcesContent": ["/* eslint-disable @typescript-eslint/no-unsafe-return */\nimport { Injectable } from '@angular/core';\nimport { User } from '@biz-nest/auth-client';\nimport {\n  Buyer,\n  Company,\n  CompanySubscription,\n  Customer,\n  Review,\n  Staff,\n  getGuestInfo\n} from '@biz-nest/commerce-client';\nimport { FrontendLogger, IcommerceUser, IecommerceGuest } from '@biz-nest/core-client';\nimport { DeliveryManager, EagleInfoClientError, Imanager, VendorManager } from '@main-shared-lib';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DataService {\n  isSuperAdmin = false;\n  authUser?: User;\n  currentCompany?: Company;\n  buyerProfile?: Buyer;\n  guestProfile?: IecommerceGuest<string, IcommerceUser>;\n  staffProfile?: Staff;\n  vendorManagerProfile?: VendorManager;\n  deliveryManagerProfile?: DeliveryManager;\n  companyProfile?: Company;\n  profileType: 'buyer' | 'staff' | 'vendorManager' | 'deliveryManager' | 'company' = 'buyer';\n\n  customers: Customer[] = [];\n  users: User[] = [];\n  reviews: Review[] = [];\n  companyId?: string;\n  subscriptions: CompanySubscription[] = [];\n  activeSubscription?: CompanySubscription;\n\n  // inv related\n  stateDataRelated;\n\n  // misc\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  stateDataUserSelect: any = {};\n\n  private chatServerUrl?: string;\n\n  constructor() { }\n\n  setChatServerUrl(chatServerUrl: string) {\n    this.chatServerUrl = chatServerUrl;\n  }\n\n\n  async getCurrentCompany() {\n    try {\n      FrontendLogger.debug('getCurrentCompany');\n\n      FrontendLogger.debug('getCurrentCompany companyId', this.companyId);\n\n      if (!this.companyId) {\n        FrontendLogger.error('getCurrentCompany companyId is undefined');\n\n        return;\n      }\n\n\n      const company = await Company.getOne(this.companyId);\n\n      if (company) {\n        FrontendLogger.debug('SETN COMPANY');\n        this.currentCompany = company;\n      }\n    } catch (error) {\n      FrontendLogger.error(error);\n    }\n  }\n\n  async getActiveSubscriptions() {\n    // TODO\n  }\n\n  getUserNames(): string {\n    switch (this.profileType) {\n      case 'staff':\n        if (!this.staffProfile) {\n          return '';\n        }\n\n        return this.staffProfile.commerceUser?.firstName + ' ' + this.staffProfile.commerceUser?.lastName;\n      case 'vendorManager':\n        if (!this.vendorManagerProfile) {\n          return '';\n        }\n\n        return this.vendorManagerProfile.manager?.firstName + ' ' + this.vendorManagerProfile.manager?.lastName;\n      case 'deliveryManager':\n        if (!this.deliveryManagerProfile) {\n          return '';\n        }\n\n        return this.deliveryManagerProfile.manager?.firstName + ' ' + this.deliveryManagerProfile.manager?.lastName;\n      case 'company':\n        if (!this.companyProfile) {\n          return '';\n        }\n\n        return typeof this.companyProfile.owner === 'object' ?\n          this.companyProfile.owner?.firstName + ' ' + this.companyProfile.owner?.lastName : '';\n      case 'buyer':\n        if (!this.buyerProfile) {\n          return '';\n        }\n\n        return this.buyerProfile?.firstName + ' ' + this.buyerProfile?.lastName;\n      default:\n        return '';\n    }\n  }\n\n  getUserPhoto(): string {\n    switch (this.profileType) {\n      case 'staff':\n        if (!this.staffProfile) {\n          return '';\n        }\n\n        return this.extraxtPhoto(this.staffProfile.commerceUser);\n      case 'vendorManager':\n        if (!this.vendorManagerProfile) {\n          return '';\n        }\n\n        return this.extraxtPhoto(this.vendorManagerProfile.manager);\n      case 'deliveryManager':\n        if (!this.deliveryManagerProfile) {\n          return '';\n        }\n\n        return this.extraxtPhoto(this.deliveryManagerProfile.manager);\n      case 'company':\n        if (!this.companyProfile) {\n          return '';\n        }\n\n        if (typeof this.companyProfile.owner === 'string') {\n          return '';\n        }\n\n        return this.extraxtPhoto(this.companyProfile.owner);\n      case 'buyer':\n        if (!this.buyerProfile) {\n          return '';\n        }\n\n        return this.extraxtPhoto(this.buyerProfile);\n      default:\n        return '';\n    }\n  }\n\n  extraxtPhoto(user: IcommerceUser | Imanager | Buyer) {\n    if (typeof user.photos === 'string') {\n      return user.photos;\n    }\n\n    return user.profilePicture?.url || '';\n  }\n\n  getUrId(): string {\n    switch (this.profileType) {\n      case 'staff':\n        if (!this.staffProfile) {\n          return '';\n        }\n\n        return this.staffProfile.commerceUser?.urId;\n      case 'vendorManager':\n        if (!this.vendorManagerProfile) {\n          return '';\n        }\n\n        return this.vendorManagerProfile.manager?.urId;\n      case 'deliveryManager':\n        if (!this.deliveryManagerProfile) {\n          return '';\n        }\n\n        return this.deliveryManagerProfile.manager?.urId;\n      case 'company':\n        if (!this.companyProfile) {\n          return '';\n        }\n\n        if (typeof this.companyProfile.owner === 'string') {\n          return '';\n        }\n\n        return this.companyProfile.owner?.urId;\n      case 'buyer':\n        if (!this.buyerProfile) {\n          return '';\n        }\n\n        return this.buyerProfile?.urId;\n      default:\n        return '';\n    }\n  }\n\n\n  getUser(): IcommerceUser | Imanager | Buyer | null {\n    switch (this.profileType) {\n      case 'staff':\n        if (!this.staffProfile) {\n          return null;\n        }\n\n        return this.staffProfile.commerceUser;\n      case 'vendorManager':\n        if (!this.vendorManagerProfile) {\n          return null;\n        }\n\n        return this.vendorManagerProfile.manager;\n      case 'deliveryManager':\n        if (!this.deliveryManagerProfile) {\n          return null;\n        }\n\n        return this.deliveryManagerProfile.manager;\n      case 'company':\n        if (!this.companyProfile) {\n          return null;\n        }\n\n        if (typeof this.companyProfile.owner === 'string') {\n          return null;\n        }\n\n        return this.companyProfile.owner;\n      case 'buyer':\n        if (!this.buyerProfile) {\n          return null;\n        }\n\n        return this.buyerProfile;\n      default:\n        return null;\n    }\n  }\n\n\n  setCompanyId(companyId: string) {\n    this.companyId = companyId;\n  }\n\n  getChatInfo() {\n    const user = this.getUser();\n\n    if (!user) {\n      throw new EagleInfoClientError('user is undefined');\n    }\n\n\n    return {\n      _id: user._id,\n      names: this.getUserNames(),\n      photo: this.getUserPhoto(),\n      chatServerUrl: this.chatServerUrl\n    };\n  }\n\n  async getGuest() {\n    try {\n      const guest = await getGuestInfo();\n\n      this.guestProfile = guest;\n    } catch (error) {\n      FrontendLogger.error(error);\n    }\n  }\n}\n\n"],
  "mappings": "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",
  "names": []
}
