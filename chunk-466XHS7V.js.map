{
  "version": 3,
  "sources": ["projects/shared-lib/src/lib/services/theme.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\nimport { WebStorageService, WindowService } from '@front-shared-lib';\n\nexport type TthemePref = 'system' | 'light' | 'dark';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ThemeService {\n  themeMode: TthemePref = 'system';\n  currentIcon = 'computer';\n  toggle = false;\n  private prefersDark;\n\n  constructor(\n    private storage: WebStorageService,\n    private windowService: WindowService\n  ) {}\n\n  toggleTheme(themeMode: TthemePref, currentIcon: string) {\n    this.themeMode = themeMode;\n    this.storage.set('theme', themeMode);\n    this.currentIcon = currentIcon;\n    switch (themeMode) {\n      case 'dark':\n        this.setTheme(true);\n        break;\n      case 'light':\n        this.setTheme(false);\n        break;\n      case 'system':{\n        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');\n\n        this.setTheme(prefersDark.matches);\n        break;\n      }\n    }\n  }\n\n  setTheme(isDark: boolean) {\n    if (isDark) {\n      document.body.classList.add('dark-theme');\n    } else {\n      document.body.classList.remove('dark-theme');\n    }\n  }\n\n  initTheme() {\n    let theme = this.storage.get('theme') as TthemePref;\n\n    console.log('store theme,', theme);\n    let currentIcon : string;\n\n    switch (theme) {\n      case 'dark':\n        currentIcon = 'dark_mode';\n        break;\n      case 'light':\n        currentIcon = 'light_mode';\n        break;\n      default: {\n        currentIcon = 'computer';\n        theme = 'system';\n        break;\n      }\n    }\n    this.toggleTheme(theme, currentIcon);\n    this.watchMedia();\n  }\n\n  watchMedia() {\n    window.matchMedia('(prefers-color-scheme: dark)')\n      .addEventListener('change', ({ matches }) => {\n        if (this.themeMode === 'system') {\n          this.setTheme(matches);\n        }\n      });\n  }\n\n  loadApp() {\n    if (this.windowService.getWindow()) {\n      this.prefersDark = this.windowService.getWindow()?.matchMedia('(prefers-color-scheme: dark)');\n      // Listen for changes to the prefers-color-scheme media query\n      this.prefersDark.addListener((e) => this.checkToggle(e.matches));\n      this.checkToggle(this.prefersDark.matches);\n    }\n  }\n\n  checkToggle(val: boolean) {\n    this.toggle = val;\n    if (this.windowService.getWindow()) {\n      this.windowService.doc.body.classList.toggle('dark', val);\n    }\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;AAQM,IAAO,eAAP,MAAO,cAAY;EAMvB,YACU,SACA,eAA4B;AAD5B,SAAA,UAAA;AACA,SAAA,gBAAA;AAPV,SAAA,YAAwB;AACxB,SAAA,cAAc;AACd,SAAA,SAAS;EAMN;EAEH,YAAY,WAAuB,aAAmB;AACpD,SAAK,YAAY;AACjB,SAAK,QAAQ,IAAI,SAAS,SAAS;AACnC,SAAK,cAAc;AACnB,YAAQ,WAAW;MACjB,KAAK;AACH,aAAK,SAAS,IAAI;AAClB;MACF,KAAK;AACH,aAAK,SAAS,KAAK;AACnB;MACF,KAAK,UAAS;AACZ,cAAM,cAAc,OAAO,WAAW,8BAA8B;AAEpE,aAAK,SAAS,YAAY,OAAO;AACjC;MACF;IACF;EACF;EAEA,SAAS,QAAe;AACtB,QAAI,QAAQ;AACV,eAAS,KAAK,UAAU,IAAI,YAAY;IAC1C,OAAO;AACL,eAAS,KAAK,UAAU,OAAO,YAAY;IAC7C;EACF;EAEA,YAAS;AACP,QAAI,QAAQ,KAAK,QAAQ,IAAI,OAAO;AAEpC,YAAQ,IAAI,gBAAgB,KAAK;AACjC,QAAI;AAEJ,YAAQ,OAAO;MACb,KAAK;AACH,sBAAc;AACd;MACF,KAAK;AACH,sBAAc;AACd;MACF,SAAS;AACP,sBAAc;AACd,gBAAQ;AACR;MACF;IACF;AACA,SAAK,YAAY,OAAO,WAAW;AACnC,SAAK,WAAU;EACjB;EAEA,aAAU;AACR,WAAO,WAAW,8BAA8B,EAC7C,iBAAiB,UAAU,CAAC,EAAE,QAAO,MAAM;AAC1C,UAAI,KAAK,cAAc,UAAU;AAC/B,aAAK,SAAS,OAAO;MACvB;IACF,CAAC;EACL;EAEA,UAAO;AACL,QAAI,KAAK,cAAc,UAAS,GAAI;AAClC,WAAK,cAAc,KAAK,cAAc,UAAS,GAAI,WAAW,8BAA8B;AAE5F,WAAK,YAAY,YAAY,CAAC,MAAM,KAAK,YAAY,EAAE,OAAO,CAAC;AAC/D,WAAK,YAAY,KAAK,YAAY,OAAO;IAC3C;EACF;EAEA,YAAY,KAAY;AACtB,SAAK,SAAS;AACd,QAAI,KAAK,cAAc,UAAS,GAAI;AAClC,WAAK,cAAc,IAAI,KAAK,UAAU,OAAO,QAAQ,GAAG;IAC1D;EACF;;;uBArFW,eAAY,mBAAA,iBAAA,GAAA,mBAAA,aAAA,CAAA;IAAA;EAAA;;4EAAZ,eAAY,SAAZ,cAAY,WAAA,YAFX,OAAM,CAAA;EAAA;;",
  "names": []
}
